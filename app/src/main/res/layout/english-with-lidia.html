<div id="englishWorkspace" class="page-section app-shell-panel active">
  <header class="page-header">
    <h1>English with Lidia API workspace</h1>
    <p>Build the home feed and lesson experiences that power English with Lidia. Follow the same curation workflow as the App Toolkit workspace to keep data quality high across both payload types.</p>
  </header>
  <!-- Change Rationale: The workspace dashboard now relies on a shared partial so IDs and helper copy remain configurable
       without duplicating the insight and pipeline layout. -->
  <section
    class="workspace-dashboard"
    data-slot="workspace-dashboard"
    data-home-icon="view_agenda"
    data-home-label="Home cards tracked"
    data-home-helper="Live count mirrors the JSON preview."
    data-home-count-id="englishHomeCardCount"
    data-release-icon="task_alt"
    data-release-label="Release ready"
    data-release-helper="Entries that meet required metadata."
    data-release-ready-id="englishReleaseReadyCount"
    data-blocks-icon="list_alt"
    data-blocks-label="Blocks per lesson"
    data-blocks-helper="Average content blocks for the active lesson."
    data-blocks-count-id="englishLessonBlockAverage"
    data-last-edited-id="englishLastEdited"
    data-last-edited-default="awaiting changes"
    data-pulse-id="englishWorkspacePulse"
    data-pulse-default-text="Review entries to unlock insights."
    data-progress-id="englishReleaseProgress"
    data-legend-primary-text="Home"
    data-legend-secondary-text="Lesson"
  >
    <template slot="plan-steps">
      <li><span class="plan-step-title">Refine home feed metadata</span> <span class="plan-step-meta" id="englishReviewCount">0 cards needing attention</span></li>
      <li><span class="plan-step-title">Validate lesson structure</span> <span class="plan-step-meta">Ensure title, metadata, and blocks render cleanly.</span></li>
      <li><span class="plan-step-title">Publish to GitHub</span> <span class="plan-step-meta">Ship debug and release payloads together.</span></li>
    </template>
    <template slot="release-tips">
      <li>Populate lesson_id, lesson_type, and thumbnails for each card.</li>
      <li>Provide at least four content blocks per lesson to keep pacing.</li>
    </template>
  </section>
  <div class="card-body">
    <h2>Before you start</h2>
    <ul>
      <li>Home cards should include <strong>lesson_id</strong>, <strong>lesson_type</strong>, and a <strong>lesson_title</strong> for quick scanning.</li>
      <li>Use <code>content_player</code>, <code>image</code>, and ad block types to match the production schema for lessons.</li>
      <li>Publish-ready JSON now lives under <code>api/english_with_lidia/v1/[debug|release]/ro/[home|lessons]/</code>. Keep both channels aligned before opening a PR.</li>
      <li>Fetch the latest payloads before editing to compare changes in the diff sheet and verify the GitHub Pages output.</li>
    </ul>
  </div>
  <div class="card-body">
    <div class="builder-remote-header">
      <div>
        <h2>Fetch existing JSON</h2>
        <p>Pull the latest home or lesson payload before editing entries.</p>
      </div>Home Lesson
    </div>
    <div class="builder-remote-controls">
      <span class="material-symbols-outlined">link</span> <span class="material-symbols-outlined">cloud_download</span> Fetch from URL
    </div>
    <div class="builder-remote-presets" aria-label="Quick fetch shortcuts">
      <span class="builder-remote-presets-label">Quick links</span> <span class="material-symbols-outlined">download</span> Home · Debug <span class="material-symbols-outlined">download</span> Home · Release <span class="material-symbols-outlined">download</span> Lesson · Debug <span class="material-symbols-outlined">download</span> Lesson · Release
    </div>
  </div>
  <div class="card-body">
    <div class="builder-remote-header">
      <div>
        <h2>Publish to GitHub</h2>
        <p>Use the GitHub Contents API to update payloads once the previews are valid. Tokens are used only for this request and never stored.</p>
      </div>
    </div>
    <div class="builder-github-note" role="note">
      <p><strong>Create a personal access token</strong> with <em>Repository permissions → Contents: Read & write</em>. Keep the token outside of source control and scope it to this repository.</p>
    </div>
    <div class="builder-github-launch">
      <span class="material-symbols-outlined">rocket_launch</span> Open publish wizard
      <p class="builder-github-helper">Validate the previews first, then follow the guided steps to publish.</p>
    </div>
  </div>
  <div class="pager" id="englishPager" data-pager="">
    <div class="pager-tabs" role="tablist">
      <button type="button" class="pager-tab active" data-page="home" role="tab" aria-selected="true">Home API</button> <button type="button" class="pager-tab" data-page="lesson" role="tab" aria-selected="false">Lesson API</button>
    </div>
    <div class="pager-pages">
      <section class="pager-page active" data-page="home" role="tabpanel">
        <div class="card-body">
          <h2>Home feed essentials</h2>
          <ul>
            <li>Cards need <strong>lesson_id</strong>, <strong>lesson_type</strong>, and optionally title, thumbnail, and deep link.</li>
            <li>Use <code>banner_image_local</code> or <code>row_buttons_local</code> for static UI components and ad identifiers for monetized slots.</li>
          </ul>
        </div>
        <section class="api-builder" id="englishHomeBuilder" data-builder-type="english-home">
          <div class="builder-toolbar">
            <div class="builder-toolbar-actions">
              <span class="material-symbols-outlined">add</span> Add card <span class="material-symbols-outlined">upload</span> Import JSON <input type="file" id="englishHomeImportInput" accept="application/json" hidden=""> <span class="material-symbols-outlined">refresh</span> Clear cards
            </div>
            <div class="builder-toolbar-meta">
              <div class="toolbar-status" role="status" aria-live="polite">
                <span class="toolbar-status-label">Home status</span> <span class="toolbar-status-value" id="englishHomeToolbarPulse">Awaiting input</span>
              </div>
            </div>
          </div>
          <div class="builder-layout builder-columns">
            <div class="builder-forms" id="englishHomeEntries" aria-live="polite"></div>
            <aside class="builder-preview" aria-label="JSON preview">
              <div class="preview-header">
                <h2>Preview & export</h2>
                <p>Review the generated payload before committing.</p>
              </div>
              <textarea id="englishHomePreview" class="preview-textarea" readonly spellcheck="false" aria-label="English with Lidia home JSON preview"></textarea>
              <div class="preview-validation" id="englishHomeValidation" role="status" aria-live="polite"></div>
              <div class="preview-actions">
                <span class="material-symbols-outlined">content_copy</span> Copy JSON Download <span class="material-symbols-outlined">download</span>
              </div>
            </aside>
          </div>
        </section>
      </section>
      <section class="pager-page" data-page="lesson" role="tabpanel">
        <div class="card-body">
          <h2>Lesson payload structure</h2>
          <ul>
            <li>Provide a <strong>lesson_title</strong> and add content blocks in the order they appear in the app.</li>
            <li>Block types include audio players, headers, rich text, images, and ad placements. Optional fields appear based on the selected type.</li>
          </ul>
        </div>
        <section class="api-builder" id="englishLessonBuilder" data-builder-type="english-lesson">
          <div class="builder-toolbar">
            <div class="toolbar-actions">
              <span class="material-symbols-outlined">add</span> Add block <span class="material-symbols-outlined">upload</span> Import JSON <input type="file" id="englishLessonImportInput" accept="application/json" hidden=""> <span class="material-symbols-outlined">refresh</span> Clear blocks
            </div>
            <div class="builder-toolbar-meta">
              <div class="toolbar-status" role="status" aria-live="polite">
                <span class="toolbar-status-label">Lesson status</span> <span class="toolbar-status-value" id="englishLessonToolbarPulse">Awaiting input</span>
              </div>
            </div>
          </div>
          <div class="builder-layout builder-columns">
            <div class="builder-forms">
              <div class="builder-field-collection" id="englishLessonMetadata"></div>
              <div class="builder-field-collection" id="englishLessonBlocks" aria-live="polite"></div>
            </div>
            <aside class="builder-preview" aria-label="JSON preview">
              <div class="preview-header">
                <h2>Preview & export</h2>
                <p>Blocks render in the exact order defined here.</p>
              </div>
              <textarea id="englishLessonPreview" class="preview-textarea" readonly spellcheck="false" aria-label="English with Lidia lesson JSON preview"></textarea>
              <div class="preview-validation" id="englishLessonValidation" role="status" aria-live="polite"></div>
              <div class="preview-actions">
                <span class="material-symbols-outlined">content_copy</span> Copy JSON Download <span class="material-symbols-outlined">download</span>
              </div>
            </aside>
          </div>
        </section>
      </section>
    </div>
  </div>
  <div slot="headline">
    Workspace diff
  </div>
  <div slot="supporting-text">
    Compare the current workspace against the last fetched payloads.
  </div>
  <div slot="content" class="diff-sheet-content">
    <div id="englishDiffContent" class="diff-view diff-view--empty" role="status" aria-live="polite"></div>
  </div>
  <div slot="headline">
    Focus session
  </div>
  <div slot="content" class="focus-dialog-content">
    <div class="focus-dialog-timer" id="englishFocusTimer" aria-live="polite">
      25:00
    </div>
    <div class="focus-dialog-controls">
      Start Pause Reset
    </div>
    <div class="focus-dialog-checklist">
      <h3>Pending checklist</h3>
    </div>
  </div>
  <div slot="actions">
    Close Save note
  </div>
  <div slot="headline">
    Publish to GitHub
  </div>
  <div slot="content" class="github-dialog-content">
    <div class="github-step" data-step="authenticate"></div>
    <div class="github-step" data-step="target">
      Home · Debug Home · Release Lesson · Debug Lesson · Release
    </div>
    <div class="github-step" data-step="review">
      <p class="github-review-copy">Confirm the diff in the side sheet and publish when ready.</p>
      <div class="github-status" id="englishGithubStatus" role="status" aria-live="polite"></div>
    </div>
  </div>
  <div slot="actions" class="github-dialog-actions">
    Cancel Back Next
  </div>
</div>