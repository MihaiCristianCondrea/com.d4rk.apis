<div id="appToolkitPage" class="page-section active">
  <header class="page-header">
    <h1>App Toolkit API workspace</h1>
    <p>
      Configure the JSON payload that powers the App Toolkit catalog. The
      builder mirrors the production schema so you can manage listings for both
      debug and release channels with confidence.
    </p>
  </header>

  <md-filled-card class="guidance-card">
    <div class="card-body">
      <h2>Before you start</h2>
      <ul>
        <li>
          Each app entry must include <strong>name</strong>,
          <strong>packageName</strong>, <strong>category</strong>, and an
          <strong>iconLogo</strong> URL.
        </li>
        <li>
          Screenshots appear in the same order they are added. Provide at least
          three URLs for release builds.
        </li>
        <li>
          When you are done, export the JSON and replace the existing file in
          <code>App Toolkit/[debug|release]/en/home/api_android_apps.json</code>.
        </li>
        <li>
          Use <strong>Fetch existing JSON</strong> to pull the latest data from a
          remote file before editing.
        </li>
      </ul>
    </div>
  </md-filled-card>

  <section
    class="api-builder"
    id="appToolkitBuilder"
    data-builder-type="app-toolkit"
  >
    <div class="builder-toolbar">
      <md-filled-button id="appToolkitAddApp">
        <md-icon slot="icon"
          ><span class="material-symbols-outlined">add</span></md-icon
        >
        Add app
      </md-filled-button>
      <md-outlined-button id="appToolkitImportButton">
        <md-icon slot="icon"
          ><span class="material-symbols-outlined">upload</span></md-icon
        >
        Import JSON
      </md-outlined-button>
      <input
        type="file"
        id="appToolkitImportInput"
        accept="application/json"
        hidden
      />
      <md-text-button id="appToolkitResetButton">
        <md-icon slot="icon"
          ><span class="material-symbols-outlined">refresh</span></md-icon
        >
        Clear workspace
      </md-text-button>
    </div>

    <md-filled-card class="builder-remote-card" id="appToolkitRemoteImport">
      <div class="card-body">
        <div class="builder-remote-header">
          <div>
            <h2>Fetch existing JSON</h2>
            <p>Pull the latest payload before you start editing entries.</p>
          </div>
        </div>
        <div class="builder-remote-controls">
          <md-outlined-text-field
            id="appToolkitFetchInput"
            type="url"
            label="JSON URL"
            placeholder="https://example.com/api_android_apps.json"
            supporting-text="Paste a direct link to the current api_android_apps.json file"
            spellcheck="false"
          >
            <md-icon slot="leading-icon"
              ><span class="material-symbols-outlined">link</span></md-icon
            >
          </md-outlined-text-field>
          <md-filled-tonal-button id="appToolkitFetchButton">
            <md-icon slot="icon"
              ><span class="material-symbols-outlined">cloud_download</span></md-icon
            >
            Fetch from URL
          </md-filled-tonal-button>
        </div>
        <div class="builder-remote-presets" aria-label="Quick fetch shortcuts">
          <span class="builder-remote-presets-label">Quick links</span>
          <md-text-button
            data-app-toolkit-preset="https://raw.githubusercontent.com/MihaiCristianCondrea/com.d4rk.apis/refs/heads/main/App%20Toolkit/debug/en/home/api_android_apps.json"
            id="appToolkitDebugPreset"
          >
            <md-icon slot="icon"
              ><span class="material-symbols-outlined">download</span></md-icon
            >
            Debug · EN
          </md-text-button>
          <md-text-button
            data-app-toolkit-preset="https://raw.githubusercontent.com/MihaiCristianCondrea/com.d4rk.apis/refs/heads/main/App%20Toolkit/release/en/home/api_android_apps.json"
            id="appToolkitReleasePreset"
          >
            <md-icon slot="icon"
              ><span class="material-symbols-outlined">download</span></md-icon
            >
            Release · EN
          </md-text-button>
        </div>
      </div>
    </md-filled-card>

    <md-filled-card class="builder-remote-card" id="appToolkitGithubCard">
      <div class="card-body">
        <div class="builder-remote-header">
          <div>
            <h2>Publish to GitHub</h2>
            <p>
              Use the GitHub Contents API to update the catalog once the JSON
              preview is valid. Tokens are used only for this request and never
              stored.
            </p>
          </div>
        </div>
        <div class="builder-github-fields">
          <label class="api-field" for="appToolkitGithubToken">
            <span class="api-field-label">Personal access token</span>
            <input
              id="appToolkitGithubToken"
              class="api-input"
              type="password"
              autocomplete="off"
              spellcheck="false"
              placeholder="ghp_..."
              aria-describedby="appToolkitGithubTokenHelp"
            />
            <span class="api-field-helper" id="appToolkitGithubTokenHelp"
              >Requires the <code>repo</code> scope. Paste the token or load it
              from a text file.</span
            >
          </label>
          <div class="api-field-actions">
            <input
              type="file"
              id="appToolkitGithubTokenFile"
              accept="text/plain,.txt,.token"
              hidden
            />
            <md-outlined-button
              type="button"
              id="appToolkitGithubTokenFileButton"
            >
              <md-icon slot="icon"
                ><span class="material-symbols-outlined">description</span></md-icon
              >
              Load token from file
            </md-outlined-button>
          </div>
          <label class="api-field" for="appToolkitGithubRepo">
            <span class="api-field-label">Repository (owner/name)</span>
            <input
              id="appToolkitGithubRepo"
              class="api-input"
              type="text"
              value="MihaiCristianCondrea/com.d4rk.apis"
              spellcheck="false"
            />
          </label>
          <label class="api-field" for="appToolkitGithubBranch">
            <span class="api-field-label">Branch</span>
            <input
              id="appToolkitGithubBranch"
              class="api-input"
              type="text"
              value="main"
              spellcheck="false"
            />
          </label>
          <label class="api-field" for="appToolkitGithubMessage">
            <span class="api-field-label">Commit message</span>
            <input
              id="appToolkitGithubMessage"
              class="api-input"
              type="text"
              value="chore(app-toolkit): update catalog"
              spellcheck="false"
            />
          </label>
          <label class="api-field" for="appToolkitGithubChannel">
            <span class="api-field-label">Target channel</span>
            <select id="appToolkitGithubChannel" class="api-select">
              <option value="debug">Debug</option>
              <option value="release">Release</option>
              <option value="both">Debug &amp; Release</option>
            </select>
          </label>
        </div>
        <div class="builder-github-actions">
          <md-filled-button id="appToolkitGithubSubmit">
            <md-icon slot="icon"
              ><span class="material-symbols-outlined">cloud_upload</span></md-icon
            >
            Publish JSON
          </md-filled-button>
          <div
            class="preview-validation"
            id="appToolkitGithubStatus"
            role="status"
            aria-live="polite"
          ></div>
        </div>
      </div>
    </md-filled-card>

    <div class="builder-layout">
      <div class="builder-forms" id="appToolkitEntries" aria-live="polite"></div>
      <aside class="builder-preview" aria-label="JSON preview">
        <div class="preview-header">
          <h2>Preview &amp; export</h2>
          <p>Changes update automatically as you edit entries.</p>
        </div>
        <textarea
          id="appToolkitPreview"
          class="preview-textarea"
          readonly
          spellcheck="false"
          aria-label="App Toolkit JSON preview"
        ></textarea>
        <div
          class="preview-validation"
          id="appToolkitValidation"
          role="status"
          aria-live="polite"
        ></div>
        <div class="preview-actions">
          <md-filled-tonal-button id="appToolkitCopyButton">
            <md-icon slot="icon"
              ><span class="material-symbols-outlined">content_copy</span></md-icon
            >
            Copy JSON
          </md-filled-tonal-button>
          <md-outlined-button id="appToolkitDownloadButton" trailing-icon>
            Download
            <md-icon slot="icon"
              ><span class="material-symbols-outlined">download</span></md-icon
            >
          </md-outlined-button>
        </div>
      </aside>
    </div>
  </section>
</div>
