/* Change Rationale: Navigation styling now defers to BeerCSS defaults so the drawer
 * and app bar inherit stock spacing, shapes, and typography. Only minimal layout
 * glue remains to keep the shell sticky and the nav rows aligned.
 */


/* Change Rationale: The navigation mount is injected before main content, so without
 * fixed positioning it participates in normal layout and pushes routed pages below the fold.
 * Keeping the mount out of flow restores the intended Material 3 shell geometry.
 */
#appNavigationMount {
  position: fixed;
  inset: 0;
  /* Change Rationale: In compact layouts the drawer must render over the top
   * app bar (Material/BeerCSS behavior), so the mount sits above the app bar
   * and the desktop breakpoint later lowers it for rail mode.
   */
  z-index: 100;
  pointer-events: none;
}

#appNavigationMount .app-navigation-rail,
#appNavigationMount .navigation-drawer {
  pointer-events: auto;
}

/* --- Top App Bar --- */
/* Change Rationale: The top app bar now relies on BeerCSS's `fixed` header
 * behavior for stickiness, so only minimal sizing remains here.
 */
.app-top-app-bar {
  width: 100%;
  /* Change Rationale: Keep the app bar above page content/dropdowns while still
   * allowing compact drawer surfaces to overlay it from a higher nav mount layer.
   */
  z-index: 90;
  /* Change Rationale: Keep the app bar tied to neutral surface tokens and
   * explicitly override BeerCSS tint helpers so the header never turns purple.
   */
  background-color: var(--app-surface) !important;
  color: var(--app-on-surface) !important;
}

.app-top-app-bar nav {
  display: flex;
  align-items: center;
  width: 100%;
  min-height: var(--app-top-app-bar-height);
}

.app-top-app-bar h5 {
  margin: 0;
}

/* --- Navigation Drawer --- */

.navigation-drawer-backdrop {
  position: fixed;
  inset: 0;
  inset-block-start: 0;
  inline-size: 100vw;
  block-size: 100dvh;
  min-block-size: 0;
  padding: 0;
  border-radius: 0 !important;
  background: var(--app-overlay-bg-color);
  border: 0;
  opacity: 0;
  visibility: hidden;
  pointer-events: none;
  transition: opacity var(--app-motion-duration-medium) var(--app-motion-ease-standard), visibility 0ms linear var(--app-motion-duration-medium);
  /* Change Rationale: Backdrop should sit below the drawer sheet but above app
   * content; z-index is scoped within #appNavigationMount.
   */
  z-index: 1;
}

.navigation-drawer-backdrop.active {
  opacity: 1;
  visibility: visible;
  pointer-events: auto;
  transition: opacity var(--app-motion-duration-medium) var(--app-motion-ease-standard);
}

/* Change Rationale: Drawer geometry and motion now mirror BeerCSS `dialog.left`
 * semantics (rounded trailing edge + full off-canvas translate) while keeping
 * Material 3/Compose directional easing for Android-native behavior.
 */
.navigation-drawer {
  position: fixed;
  inset-inline-start: 0;
  inset-block-start: 0;
  inline-size: var(--app-drawer-inline-size);
  /* Change Rationale: Use dynamic viewport height at every breakpoint so drawer
   * geometry matches compact/desktop and avoids top-strip scrim artifacts.
   */
  block-size: 100dvh;
  overflow: hidden;
  display: flex;
  flex-direction: column;
  /* Change Rationale: Match the native Material/Compose modal drawer surface
   * (`dialog.left`) so the sheet reads as a neutral side panel over app content.
   */
  background-color: var(--app-drawer-bg-color) !important;
  color: var(--app-text-color);
  /* Change Rationale: Desktop could show a thin tinted seam at the sheet edge,
   * so the drawer surface now explicitly removes framework elevation artifacts.
   */
  border: 0 !important;
  border-top: 0 !important;
  outline: 0 !important;
  background-image: none !important;
  border-start-end-radius: 1rem;
  border-end-end-radius: 1rem;
  box-shadow: 0 0.25rem 0.75rem 0 rgb(0 0 0 / 0.32);
  transform: translate3d(-100%, 0, 0);
  opacity: 1 !important;
  visibility: hidden;
  pointer-events: none;
  animation: none !important;
  transition: transform var(--app-motion-duration-medium) var(--app-motion-ease-decelerate), visibility 0ms linear var(--app-motion-duration-medium);
  will-change: transform;
  z-index: 2;
}


.navigation-drawer.active {
  transform: translate3d(0, 0, 0);
  visibility: visible;
  pointer-events: auto;
  transition: transform var(--app-motion-duration-medium) var(--app-motion-ease-decelerate);
}


/* Change Rationale: BeerCSS applies high-specificity `nav.left` and responsive
 * helper rules (e.g. `.s` at desktop), so this guard ensures the drawer remains
 * a fixed off-canvas sheet instead of collapsing into a top strip.
 */
nav.navigation-drawer.left.s {
  position: fixed;
  inset: 0 auto 0 0;
  padding: 0;
  margin: 0;
  text-align: start;
  display: flex !important;
  transform: translate3d(-100%, 0, 0);
}

nav.navigation-drawer.left.s.active {
  transform: translate3d(0, 0, 0);
}

/* Change Rationale: Backdrop is implemented with a native button element, and
 * BeerCSS button active states can leak a 40px tinted bar unless reset here.
 */
button.navigation-drawer-backdrop {
  inline-size: 100vw;
  block-size: 100dvh;
  min-block-size: 0;
  padding: 0;
  border-radius: 0 !important;
  background: var(--app-overlay-bg-color) !important;
}

/* Change Rationale: Respect user motion preferences while preserving the same
 * open/closed state semantics for drawer and scrim interactions.
 */
@media (prefers-reduced-motion: reduce) {
  .navigation-drawer,
  .navigation-drawer.active,
  .navigation-drawer-backdrop,
  .navigation-drawer-backdrop.active {
    transition-duration: var(--app-motion-reduced-duration);
    transition-timing-function: linear;
  }
}

/* Change Rationale: Drawer icon controls require explicit contrast tokens so
 * actions remain legible across light/dark surfaces and selected states.
 */
.navigation-drawer .app-nav-icon-button {
  color: var(--app-text-color);
}

.navigation-drawer .app-nav-icon-button:hover,
.navigation-drawer .app-nav-icon-button:focus-visible {
  background-color: var(--app-primary-container);
  color: var(--app-on-primary-container);
}

/* Change Rationale: Footer legal actions should inherit the same palette as the
 * rest of the drawer surface instead of browser default anchor/link colors.
 */
.drawer-footer a {
  color: var(--app-text-color);
}

.drawer-footer a:hover,
.drawer-footer a:focus-visible {
  color: var(--app-link-color);
}

.drawer-content {
  flex: 1 1 auto;
  min-height: 0;
  overflow-y: auto;
}

.drawer-footer {
  flex-shrink: 0;
  margin-top: auto;
  border-top: 1px solid var(--md-sys-color-outline-variant);
  background-color: var(--app-drawer-bg-color) !important;
}

.drawer-legal-links {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  flex-wrap: wrap;
}

/* Change Rationale: Navigation sections now hydrate dynamically, so the
 * container uses consistent vertical rhythm across rail and drawer.
 */
.navigation-section-stack {
  display: grid;
  gap: 0.75rem;
}

/* --- Navigation Rail --- */
/* Change Rationale: Pin the rail to the left edge on desktop so content never
 * centers under it and the BeerCSS layout matches the CEO reference.
 */
:root {
  --app-nav-rail-width: 280px;
  --app-nav-rail-padding: 0.75rem;
}

.app-navigation-rail {
  position: fixed;
  inset-inline-start: 0;
  inset-block-start: var(--app-top-app-bar-height);
  width: var(--app-nav-rail-width);
  height: calc(100vh - var(--app-top-app-bar-height));
  padding: var(--app-nav-rail-padding);
  overflow-y: auto;
  z-index: 0;
}

/* Change Rationale: Explicitly separate compact drawer and desktop rail behavior
 * by breakpoint so only one lateral navigation surface is interactive at a time.
 */
@media (max-width: 959px) {
  .app-navigation-rail {
    display: none;
  }
}

/* Change Rationale: Maintain readable layout when the rail is visible by
 * offsetting the main shell surfaces instead of centering underneath it.
 */
@media (min-width: 960px) {
  /* Change Rationale: Desktop now mirrors compact drawer geometry so opening the
   * menu always reveals the full side sheet instead of only tinting a top strip.
   */
  #appNavigationMount {
    z-index: 100;
  }

  .app-navigation-rail {
    display: none;
  }

  /* Change Rationale: BeerCSS size helper class (`.s`) can hide elements on
   * desktop, so force the desktop drawer/backdrop display contract explicitly.
   */
  .navigation-drawer {
    display: flex !important;
  }

  .navigation-drawer-backdrop {
    display: block !important;
  }

  /* Change Rationale: Geometry is now defined in the base drawer/backdrop rules,
   * so desktop only enforces BeerCSS visibility helpers and keeps motion parity.
   */

  /* Change Rationale: Desktop no longer reserves horizontal space for a persistent
   * rail, so app bar/content return to standard full-width shell alignment.
   */
  .app-top-app-bar nav,
  .app-shell-main,
  .app-shell-footer {
    padding-inline-start: calc(1rem + var(--safe-area-inset-left));
  }
}

/* Change Rationale: Keep nav links aligned as rows without custom padding so the
 * framework controls spacing and state styling.
 */
.app-navigation .nav-link {
  display: flex;
  align-items: center;
  text-decoration: none;
}

.app-navigation .nav-link .max {
  min-width: 0;
}

.app-navigation .nav-link small {
  display: block;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}


/* Change Rationale: BeerCSS already styles list rows; this only reinforces that selected
 * navigation rows keep the rounded container shape across rail and drawer surfaces. */
.app-navigation li.nav-item.active,
.app-navigation li.nav-item.primary-container,
.app-navigation .nav-link.active,
.app-navigation .nav-link.primary-container {
  border-radius: 999px;
  background-color: var(--app-primary-container) !important;
}

/* Change Rationale: Active destination text/icons should use the Material 3 on-primary
 * container color so selected rows match the canonical app palette instead of defaults.
 */
.app-navigation li.nav-item.active .nav-link,
.app-navigation li.nav-item.active .nav-link i,
.app-navigation li.nav-item.active .nav-link small,
.app-navigation .nav-link.active,
.app-navigation .nav-link.active i,
.app-navigation .nav-link.active small {
  color: var(--app-on-primary-container);
}


/* Change Rationale: Navigation icon actions now use one shared BeerCSS contract across app bar and drawer controls. */
.app-navigation .app-nav-icon-button,
.app-top-app-bar .app-nav-icon-button,
.theme-button-container .app-nav-icon-button {
  min-width: 2.5rem;
  min-height: 2.5rem;
  display: inline-flex;
  align-items: center;
  justify-content: center;
}
