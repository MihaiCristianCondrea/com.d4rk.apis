<!-- Change Rationale: The workspace container previously omitted the BeerCSS page helper,
     which left its spacing rules disconnected from the rest of the app shell. Adding the
     `page` class lets BeerCSS manage the baseline page layout, keeping typography and
     section rhythm consistent with Material 3 layout guidance. -->
<div id="faqPage" class="page-section app-shell-panel page active">
  <header class="page-header">
    <h1>FAQ API workspace</h1>
    <p>Publish a structured FAQ feed for app and web surfaces. The builder keeps questions, categories, featured flags, search tags, and HTML answers aligned with the GitHub Pages datasets defined in <code>./api/faq/v1/debug/catalog.json</code>. Use the catalog picker to merge multiple question sources for a product or fetch a single JSON file when iterating locally.</p>
  </header>
  <section class="faq-screen" data-faq-screen="chooser" aria-label="Select a workflow">
    <section class="faq-onboarding" aria-label="Workflow picker">
      <div class="faq-onboarding__header">
        <p class="faq-onboarding__eyebrow">Start with one workflow</p>
        <h2>Choose how you want to work on FAQs</h2>
        <p class="faq-onboarding__helper">Pick the path that matches your goal. The workspace will open the matching screen and keep you on one focused flow.</p>
      </div>
      <div class="faq-onboarding__grid">
        <!-- Change Rationale: The workflow buttons previously relied on custom card styling alone,
             which made their tap targets and corner treatment drift from BeerCSS controls. Adding
             the BeerCSS `round` helper keeps the button geometry consistent with other actions and
             aligns with Material 3's guidance for cohesive component shape. -->
        <button type="button" class="faq-landing-card round" data-faq-mode="catalog" aria-pressed="false">
          <span class="faq-landing-card__icon material-symbols-outlined">inventory_2</span>
          <div class="faq-landing-card__body">
            <p class="faq-landing-card__eyebrow">Catalog</p>
            <p class="faq-landing-card__title">Edit catalog.json</p>
            <p class="faq-landing-card__copy">Switch between debug or release and manage the source list.</p>
          </div>
        </button>
        <!-- Change Rationale: Normalize the workflow key to the singular `faq` slug so UI state matches api/faq and router anchors. -->
        <button type="button" class="faq-landing-card round" data-faq-mode="faq" aria-pressed="false">
          <span class="faq-landing-card__icon material-symbols-outlined">help_center</span>
          <div class="faq-landing-card__body">
            <p class="faq-landing-card__eyebrow">Product FAQs</p>
            <p class="faq-landing-card__title">Edit per-product FAQs</p>
            <p class="faq-landing-card__copy">Load a product from the catalog and add or edit its FAQ entries.</p>
          </div>
        </button>
      </div>
      <p id="faqModeStatus" class="faq-onboarding__status" role="status">Select a workflow to continue.</p>
    </section>
  </section>
    <section class="faq-screen" data-faq-screen="workspace" aria-label="FAQ workspace" hidden="">
    <section class="workspace-dashboard" aria-label="Workspace overview">
      <!-- Change Rationale: The insight grid now uses the shared workspace-insight-card partial so FAQ metrics mirror the same Material 3 spacing as other workspaces without duplicating markup. -->
      <div class="workspace-insight-grid" data-slot-target="faq-insights">
        <div
          class="workspace-insight-card"
          data-partial="workspace-insight-card"
          data-slot-prefix="faq-total"
          data-icon="help_center"
          data-label="FAQs tracked"
          data-helper="Live count mirrors the builder list."
          data-value-id="faqTotalCount"
          data-default-value="0"
        ></div>
        <div
          class="workspace-insight-card"
          data-partial="workspace-insight-card"
          data-slot-prefix="faq-featured"
          data-icon="star"
          data-label="Featured answers"
          data-helper="Highlighted in home experiences."
          data-value-id="faqFeaturedCount"
          data-default-value="0"
        ></div>
        <div
          class="workspace-insight-card"
          data-partial="workspace-insight-card"
          data-slot-prefix="faq-icons"
          data-icon="symptoms"
          data-label="Icon coverage"
          data-helper="Ensure every entry references a Material icon."
          data-value-id="faqIconCoverage"
          data-default-value="0/0"
        ></div>
      </div>
      <div class="workspace-secondary-grid">
        <md-filled-card class="workspace-plan">
          <div class="card-body">
            <div class="plan-header">
              <h2>Today's pipeline</h2><span class="plan-updated">Updated as you edit</span>
            </div>
            <!-- Change Rationale: Plan steps now follow BeerCSS list rows with div.max + small
                 text so list spacing remains stock and accessible. -->
            <ul class="list plan-list">
              <li class="wave round">
                <div class="max">
                  <span>Draft clear questions</span>
                  <small>Keep them scoped to one concern.</small>
                </div>
              </li>
              <li class="wave round">
                <div class="max">
                  <span>Pair with succinct HTML answers</span>
                  <small>Use paragraphs and lists for readability.</small>
                </div>
              </li>
              <li class="wave round">
                <div class="max">
                  <span>Validate &amp; export</span>
                  <small>Refresh <code>index.json</code> and category files in the repo.</small>
                </div>
              </li>
            </ul>
          </div>
        </md-filled-card>
        <md-filled-card class="workspace-release">
          <div class="card-body">
            <div class="release-header">
              <h2>Workspace status</h2>
              <p id="faqWorkspacePulse">Awaiting first entry.</p>
            </div>
            <!-- Change Rationale: Release tips now use BeerCSS list rows to keep ripple and
                 spacing consistent with other list surfaces. -->
            <ul class="list release-tips">
              <li class="wave round">
                <div class="max">
                  <span>Assign one or more categories per FAQ when it helps with grouping.</span>
                </div>
              </li>
              <li class="wave round">
                <div class="max">
                  <span>Feature the answers that deserve extra visibility in app hubs.</span>
                </div>
              </li>
              <li class="wave round">
                <div class="max">
                  <span>Icon symbols use Google's Material Symbols catalog.</span>
                </div>
              </li>
            </ul>
          </div>
        </md-filled-card>
      </div>
    </section>
    <section class="faq-nav" aria-label="FAQ workspace navigation">
      <md-filled-card class="faq-nav-card">
        <div class="faq-nav__header">
          <div class="faq-nav__header-actions">
            <md-text-button id="faqStartOverButton" has-icon>
              <md-icon slot="icon">restart_alt</md-icon>
              <span>Start over</span>
            </md-text-button>
            <p class="faq-segmented__helper">Switch workflows without leaving the FAQ route.</p>
          </div>
          <!-- Change Rationale: The FAQ panel switcher now uses the BeerCSS tabbed navigation
               pattern, replacing segmented controls so tab spacing, icon alignment, and active
               states match the rest of the BeerCSS navigation system. -->
          <nav class="tabbed" aria-label="Switch FAQ workspace view" role="tablist">
            <a
              class="active"
              aria-selected="true"
              aria-controls="faqPanelCatalog"
              data-faq-panel-control="catalog"
              role="tab"
              tabindex="0"
            >
              <i aria-hidden="true">inventory_2</i>
              <span>Catalog</span>
            </a>
            <a
              aria-selected="false"
              aria-controls="faqPanelFaq"
              data-faq-panel-control="faq"
              role="tab"
              tabindex="-1"
            >
              <i aria-hidden="true">help_center</i>
              <span>FAQs</span>
            </a>
          </nav>
        </div>
      </md-filled-card>
    </section>
    <section class="faq-panel page padding" data-faq-panel="catalog" id="faqPanelCatalog">
      <div class="card-body">
        <h2>Catalog structure</h2>
        <ul>
          <li><strong>schemaVersion</strong> tracks breaking changes across builds. The default is <code>1</code>.</li>
          <li>Each <strong>product</strong> declares its <code>name</code>, <code>productId</code>, <code>key</code>, and <strong>questionSources</strong> to merge.</li>
          <li>Toggle between <strong>debug</strong> and <strong>release</strong> to load and edit the matching catalog before exporting.</li>
        </ul>
      </div>
      <div class="card-body">
        <div class="builder-remote-header">
          <div>
            <h2>Quick fetch</h2>
            <p>Mirror the latest catalog.json for your chosen channel before editing products.</p>
          </div>
        </div>
        <div class="builder-remote-inline-action builder-toolbar-fetch-card" id="faqCatalogRemote">
          <div class="builder-toolbar-fetch">
            <div>
              <h2 class="builder-toolbar-title">Channel presets</h2>
              <p class="builder-toolbar-helper">Jump straight into the debug or release catalog.</p>
            </div>
            <div
              class="builder-remote-presets builder-remote-presets--buttons builder-toolbar-fetch__presets"
              aria-label="Catalog presets"
            >
              <span class="builder-remote-presets-label">Build channel</span>
              <md-text-button data-faq-catalog-preset="debug" class="builder-remote-inline-button" has-icon>
                <md-icon slot="icon">download</md-icon>
                <span>Debug · EN</span>
              </md-text-button>
              <md-text-button data-faq-catalog-preset="release" class="builder-remote-inline-button" has-icon>
                <md-icon slot="icon">download</md-icon>
                <span>Release · EN</span>
              </md-text-button>
            </div>
          </div>
          <p id="faqCatalogStatus" class="builder-remote-status" role="status">Choose debug or release to load the FAQ catalog.</p>
        </div>
      </div>
      <section class="builder-layout builder-columns" id="faqCatalogBuilder">
        <div class="builder-forms catalog-forms">
          <div class="catalog-schema" id="faqCatalogSchemaField"></div>
          <div class="catalog-actions">
            <div>
              <h2>Catalog products</h2>
              <p class="catalog-helper">Define every product and the FAQ sources it pulls together.</p>
            </div>
            <div class="catalog-actions__buttons">
              <md-filled-tonal-button id="faqCatalogAddProduct">
                <md-icon slot="icon">add_circle</md-icon>
                <span>Add product</span>
              </md-filled-tonal-button>
              <md-outlined-button id="faqCatalogReset">
                <md-icon slot="icon">restart_alt</md-icon>
                <span>Reset catalog</span>
              </md-outlined-button>
            </div>
          </div>
          <div id="faqCatalogProducts" class="catalog-products" aria-live="polite"></div>
        </div>
        <aside class="builder-preview" aria-label="Catalog JSON preview">
          <div class="preview-header">
            <h2>Catalog preview</h2>
            <p>Exports the schema version and every product definition.</p>
          </div>
          <textarea id="faqCatalogPreview" class="preview-textarea" readonly spellcheck="false" aria-label="Catalog JSON preview"></textarea>
          <div class="preview-validation" id="faqCatalogValidation" role="status" aria-live="polite"></div>
          <div class="preview-actions">
            <md-filled-tonal-button id="faqCatalogCopyButton">
              <md-icon slot="icon">content_copy</md-icon>
              <span>Copy JSON</span>
            </md-filled-tonal-button>
            <md-outlined-button id="faqCatalogDownloadButton">
              <md-icon slot="icon">download</md-icon>
              <span>Download</span>
            </md-outlined-button>
          </div>
        </aside>
      </section>
    </section>
    <section class="faq-panel page padding" data-faq-panel="faq" id="faqPanelFaq" hidden="">
      <section class="builder-remote-card faq-product-loader" aria-label="Product FAQ loader">
        <div class="card-body">
          <div class="builder-remote-header">
            <div>
              <h2>Add new product FAQs</h2>
              <p>Pick a product from the catalog to edit its FAQs.</p>
            </div>
          </div>
          <div class="builder-remote-picker" aria-label="Product selection">
            <div class="builder-remote-picker-select" id="faqCatalogSelect"></div>
            <md-filled-tonal-button id="faqCatalogFetchButton">
              <md-icon slot="icon">fact_check</md-icon>
              <span id="faqCatalogButtonLabel">Fetch selected product</span>
            </md-filled-tonal-button>
          </div>
          <p id="faqFetchStatus" class="builder-remote-status" role="status">Ready to fetch.</p>
        </div>
      </section>
      <section class="api-builder" id="faqBuilder" data-builder-type="faq">
        <div class="builder-toolbar">
          <div class="builder-toolbar-actions">
            <md-filled-tonal-button id="faqAddEntry">
              <md-icon slot="icon">add</md-icon>
              <span>Add FAQ</span>
            </md-filled-tonal-button>
            <md-outlined-button id="faqImportButton">
              <md-icon slot="icon">upload</md-icon>
              <span>Import JSON</span>
            </md-outlined-button>
            <input type="file" id="faqImportInput" accept="application/json" hidden="">
          </div>
          <div class="builder-toolbar-meta">
            <div class="toolbar-status" role="status" aria-live="polite">
              <span class="toolbar-status-label">Validation</span> <span class="toolbar-status-value" id="faqToolbarStatus">Awaiting input</span>
            </div>
          </div>
        </div>
        <div class="builder-layout builder-columns">
          <div class="builder-forms" id="faqEntries" aria-live="polite"></div>
          <aside class="builder-preview" aria-label="FAQ preview workspace">
            <div class="preview-grid">
              <section class="preview-card" aria-label="JSON preview">
                <div class="preview-header">
                  <h2>Preview & export</h2>
                  <p>Changes update automatically as you edit entries.</p>
                </div>
                <textarea id="faqPreview" class="preview-textarea" readonly spellcheck="false" aria-label="FAQ JSON preview"></textarea>
                <div class="preview-validation" id="faqValidation" role="status" aria-live="polite"></div>
                <div class="preview-actions">
                  <md-filled-tonal-button id="faqCopyButton">
                    <md-icon slot="icon">content_copy</md-icon>
                    <span>Copy JSON</span>
                  </md-filled-tonal-button>
                  <md-outlined-button id="faqDownloadButton">
                    <md-icon slot="icon">download</md-icon>
                    <span>Download</span>
                  </md-outlined-button>
                </div>
              </section>
              <section class="preview-card preview-card--live" aria-label="Live view">
                <!-- Change Rationale: Editors only saw JSON, so layout/icon issues surfaced late. The live view mirrors the Material list/card layout and updates as you type to expose visual regressions immediately. -->
                <div class="preview-header">
                  <h2>Live view</h2>
                  <p>See how FAQs render with icons, categories, and HTML.</p>
                </div>
                <p id="faqLivePreviewStatus" class="preview-status" role="status" aria-live="polite">Live preview will render as you type.</p>
                <p id="faqLivePreviewEmpty" class="preview-empty">Add FAQs to render the live view.</p>
                <div id="faqLivePreview" class="faq-live-preview" role="region" aria-live="polite">
                  <div id="faqLivePreviewList" class="faq-live-preview__list" role="list"></div>
                </div>
              </section>
            </div>
          </aside>
        </div>
      </section><datalist id="faqIconOptions">
    </datalist>
      <div id="faqIconPicker" class="faq-icon-picker" role="dialog" aria-modal="true" hidden="">
        <div class="faq-icon-picker__backdrop" id="faqIconPickerBackdrop" aria-hidden="true"></div>
        <div class="faq-icon-picker__panel" role="document">
          <header class="faq-icon-picker__header">
            <div>
              <h2>Select a Material icon</h2>
              <p>Search the Material Symbols catalog and insert the icon name automatically.</p>
            </div>
            <!-- Change Rationale: The icon picker close control previously used a bespoke class without
                 BeerCSS shape helpers, which made it feel inconsistent next to other icon buttons.
                 Adding BeerCSS `transparent` and `circle` helpers keeps the control aligned with
                 the framework's icon button pattern and Material 3 touch target expectations. -->
            <button type="button" class="faq-icon-picker__close transparent circle" id="faqIconPickerClose" aria-label="Close icon picker"><span class="material-symbols-outlined">close</span></button>
          </header>
          <div class="faq-icon-picker__meta">
            <span>Selected: <strong id="faqIconPickerSelection">None</strong></span> <span>Showing <strong id="faqIconPickerResultCount">0</strong> icons</span>
          </div>
          <div class="faq-icon-picker__search">
            <label class="api-field"><span class="api-field-label">Search icons</span> <input type="search" id="faqIconPickerSearch" class="api-input" placeholder="Search by name…" spellcheck="false" autocomplete="off"></label>
          </div>
          <p class="faq-icon-picker__loading" id="faqIconPickerLoading">Loading Material Symbols…</p>
          <p class="faq-icon-picker__limit" id="faqIconPickerLimit" hidden="">Showing the first 400 results. Continue typing to narrow the list.</p>
          <p class="faq-icon-picker__empty" id="faqIconPickerEmpty" hidden="">No icons match "<span id="faqIconPickerQuery"></span>"</p>
          <div class="faq-icon-picker__grid" id="faqIconPickerList" role="listbox" aria-label="Material Symbols options"></div>
          <div class="faq-icon-picker__footer">
            <!-- Change Rationale: Inline actions now use BeerCSS-native button classes with shared inline utilities
                 so lightweight footer actions stay within one control system and Material 3 sizing. -->
            <button type="button" class="button small transparent round app-ui-inline-button" id="faqIconPickerClear"><span class="material-symbols-outlined app-ui-inline-icon">backspace</span> <span>Clear selection</span></button> <span class="material-symbols-outlined">done</span> Done
          </div>
        </div>
      </div>
    </section>
  </section>
</div>
